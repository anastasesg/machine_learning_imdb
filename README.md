# Machine Learning - IMDB
Το πρόγραμμα αποτελείται από τρία αρχεία: main.py, processing.py και logistic_regression.py.

## Προεπεξερασία - preprocessing.py
Στο κομμάτι αυτό του προγράμματος υλοποιείται η προεπεξεργασία του κειμένου.
- Κλάση Data:
  - Μέθοδος `__init__`: Αρχικοποιεί την κλάση `Data` με τις κενές μεταβλητές `self.examples`, `self.labels`, `self.vocabulary`, `self.attributes` και `self.data_frame`.
  - Μέθοδος `read_vocab`: Διαβάζει το αρχείο `imdb.vocab`, εξαγάγει τις λέξεις που περιέχει και τις αποθηκεύει σε ένα `numpy.array`. Παίρνει ως όρισμα τη διαδρομή ενός αρχείου που περιέχει το λεξιλόγιο `filename`.
  - Στατική μέθοδος `example_open`: Συμπυκνώνει το άνοιγμα, διάβασμα, κλείσιμο και την τυποποίηση του κάθε παραδείγματος εκπαίδευσης. Παίρνει ως όρισμα τη διαδρομή κάποιου παραδείγματος εκπαίδευσης `filename`.
  - Μέθοδος `read_examples`: Διαβάζει κάθε παράδειγμα από τους φακέλους `train/pos`, `train/neg`, `test/pos` και `test/neg` με τη βοήθεια της μεθόδου `example_open`. Στη συνέχεια τα αποθηκεύει σε ένα αρχείο `.csv` για ευκολία ανάγνωσης σε μελλοντικές χρήσεις του προγράμματος. Παίρνει ως όρισμα τον υπερφάκελο που περιέχει τα παραδείγματα εκπαίδευσης `parent_directory`.
  - Στατική μέθοδος `information_gain`: Υπολογίζει το κέρδος πληροφορίας μίας δοσμένης λέξης. Παίρνει ως όρισμα μία λέξη `word` και επιστρέφει μία τιμή `0-1`.
  - Μέθοδος `select_attributes`: Υπολογίζει το κέρδος πληροφορίας της κάθε λέξης του λεξιλογίου και τα αποθηκεύει σε ένα αρχείο `.csv` για ευκολία ανάγνωσης σε μελλοντικά χρήσεις του προγράμματος. Παίρνει ως όρισμα το επιθυμητό πλήθος ιδιοτήτων `max_length`.
  - Μέθοδος `vectorize`: Μετατρέπει κάθε παράδειγμα εκπαίδευσης σε ένα διάνυσμα `max_length x 1` με το n-οστό στοιχείο του να είναι 1 αν η n-οστή λέξη υπάρχει και 0 διαφορετικά.
  - Μέθοδος `load_data`: Συνδυάζονται οι προηγούμενες μέθοδοι για την ανάγνωση του λεξιλογίου και των παραδειγμάτων, η επιλογή των ιδιοτήτων και η διανυσματικοποίηση. Επιστρέφει τα παραδείγματα και τις αντίστοιχες κατηγορίες τους.
  - Στατική μέθοδος `data_split`: Χωρίζει τα παραδείγματα εκπαίδευσης και τις αντίστοιχες κατηγορίες τους σε δεδομένα εκπαίδευσης και ελέγχου. Παίρνει ως όρισμα το ποσοστό του συνολικού πλήθους των παραδειγμάτων που θα χρησιμοποιηθούν ως παραδείγματα ελέγχου `split`.

## Λογιστική παλινδρόμηση - logistic_regression.py
Στο τμήμα αυτό υλοποιείται ο αλγόριθμος *λογιστικής παλινδρόμησης* και οι συναρτήσεις που συντελούν στην αξιολόγησή του.
- Συνάρτηση `confusion_matrix`: Παράγει τον πίνακα σύγχυσης της πρόβλεψης του μοντέλου. Παίρνει ως είσοδο τις πραγματικές κατηγορίες των παραδειγμάτων `y` και τις προβλεπόμενες κατηγορίες `prediction`.
- Συνάρτηση `evaluate_model`: Αξιολογεί το μοντέλο χρησιμοποιώντας τις ποσότητες accuracy, precision, recall και F1 score. Κάθε φορά εκπαιδεύει το μοντέλο χρησιμοποιώντας ένα ποσοστό των παραδειγμάτων εκπαίδευσης τα οποία προσδιορίζει ο χρήστης και έπειτα υπολογίζει τις παραπάνω ποσότητες. Στη συνέχεια τις αποθηκεύει σε ένα αρχείο `.csv` για ευκολία ανάγνωσης και αναπαραγωγής των διαγραμμάτων και τέλος, εφόσον το επιθυμεί ο χρήστης, παρουσιάζει τα αντίστοιχα γραφήματα με τη βοήθεια της εντολής `plots`. Παίρνει ως είσοδο τα ορίσματα `x_train`, `y_train`, `x_test`, `y_test`, τον ρυθμό μάθησης του μοντέλου `learning_rate`, των αριθμό των επαναλήψεων της κατάβασης βαθμίδας `iterations`, το βήμα του ποσοστού των παραδειγμάτων εκπαίδευσης `step`, το αν θα χρησιμοποιηθεί το μοντέλο του πακέτου sklearn ή όχι `sklearn` και το αν θα παραχθεί το γράφημα ή όχι `to_plot`. Επιστρέφει ένα pandas `dataframe` που περιέχει όλες τις πληροφορίες αξιολόγησης για κάθε ποσοστό.
- Κλάση `logistic_regression`:
  - Μέθοδος `__init__`: Αρχικοποιεί την κλάση `logistic_regression` αποθηκεύοντας τις τιμές που περνάει ο χρήστης στις μεταβλητές `self.learning_rate`, `self.iterations` και `self.verbose`.
  - Ιδιωτική μέθοδος `__intercept`:
  - Ιδιωτική μέθοδος `__sigmoid`: Υπολογίζει τη σιγμοειδή συνάρτηση ενός διανύσματος. Παίρνει ως όρισμα ένα διάνυσμα`z` και επιστρέφει ένα `numpy.array` ίδιου μήκους με τις τιμές της σιγμοειδούς συνάρτησης.
  - Ιδιωτική μέθοδος `__loss`: Υπολογίζει το σφάλμα της πρόβλεψης. Παίρνει ως είσοδο την όρισμα την πρόβλεψη `h` και τις πραγματικές κατηγορίες `y`
  - Μέθοδος `fit`: Πραγματοποιείται η κατάβαση βαθμίδας, ουσιαστικά η εκπαίδευση του μοντέλου. Αρχικοποιούνται τα βάρη ως ένα διάνυσμα μηδενικών. Αν η ιδιότητα `self.verbose` είναι αληθής τότε εκτυπώνει στην οθόνη την πρόοδο της εκπαίδευσης, διαφορετικά απλά εκπαιδεύει το μοντέλο. Παίρνει ως είσοδο τα παραδείγματα εκπαίδευσης `X` και τις κατηγορίες τους `y`.
  - Μέθοδος `predict`: Χρησιμοποιεί τη μέθοδο `self.__sigmoid` για να προβλέψει την πιθανότητα ένα παράδειγμα ή ένα σύνολο παραδειγμάτων ανήκει σε μία από τις δύο κατηγορίες. Παίρνει ως είσοδο το σύνολο των παραδειγμάτων `X`. Επιστρέφει ένα διάνυσμα τιμών `True/False` αν η υπολογισμένη πιθανότητα είναι μεγαλύτερη του 0.5 ή όχι. 

## Εκτέλεση και αξιολόγηση - main.py
Στο κομμάτι αυτό συνδυάζονται τα προηγούμενα δύο τμήματα για την εκτέλεση του προγράμματος.
Δηλαδή πραγματοποιείται η ανάγνωση και η προεπεξεργασία των παραδειγμάτων και στη συνέχεια η αξιολόγηση του μοντέλου.

## Χρήση και προαπαιτούμενα
Για τη χρήση του προγράμματος αρκεί κανείς να τρέξει την εντολή\
`python main.py -m <option> -l <option> -i <option> -s <option> -k <option>`\
όπου
- `-m`: το πλήθος των ιδιοτήτων. Προεπιλεγμένη τιμή 2500.
- `-l`: ο ρυθμός μάθησης. Προεπιλεγμένη τιμή 0.36.
- `-i`: ο αριθμός των επαναλήψεων. Προεπιλεγμένη τιμή 100.
- `-s`: το βήμα των ποσοστών. Προεπιλεγμένη τιμή 1.
- `-k`: προσδιορίζει αν στην αξιολόγηση θα χρησιμοποιηθεί το μοντέλο του πακέτου sklearn ή όχι. Προεπιλεγμένη τιμή `False`.

Παράδειγμα χρήσης: Με την εντολή\
`python main.py -m 10000 -l 0.01 -i 5 -p 1`\
θα επιλεχθούν 10000 ιδιότητες, ο ρυθμός μάθησης θα είναι 0.01, η κατάβαση βαθμίδας θα πραγματοποιηθεί 5 φορές και θα χρησιμοποιηθούν 1%, 2%, ..., 100% των παραδειγμάτων εκπαίδευσης για τον υπολογισμό της αποδοτικότητας.

Για την χρήση του προγράμματος είναι απαραίτητο να είναι εγκατεστημένα τα πακέτα
- `numpy`
- `pandas`
- `tqdm`
- `sklearn`
- `lxml`
- `re`
